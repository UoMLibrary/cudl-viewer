<?xml version="1.0" encoding="UTF-8"?>
<!-- This file defines the beans needed for JSP pages to insert JS/CSS assets
     into their output. -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-4.1.xsd">

    <!-- Use properties from global-properties in our bean arg placeholders -->
    <context:property-placeholder location="classpath:cudl-global.properties"/>

    <!-- Responsible for creating the uiBuildFactory bean based on
         configuration. Most importantly selecting between the devserver or
         built-in UI assets. -->
    <bean id="cudlUiBuildSelector"
          class="ulcambridge.foundations.viewer.frontend.CudlUiBuildSelector"
          autowire="constructor">

        <constructor-arg type="java.lang.String" index="1"
                         value="${cudl.ui.metadata:classpath:ulcambridge/foundations/viewer/viewer-ui/webpack-assets.json}"/>

        <constructor-arg type="java.lang.String" index="2"
                         value="${cudl.ui.dev.metadata:classpath:ulcambridge/foundations/viewer/viewer-ui/webpack-assets-dev.json}"/>

        <constructor-arg type="java.lang.String" index="3"
                         value="${cudl.ui.dependencies:classpath:ulcambridge/foundations/viewer/viewer-ui/deps.json}"/>

        <constructor-arg type="java.net.URI" index="4"
                         value="${cudl.ui.dev.baseUrl:http://localhost:8080/}"/>

        <constructor-arg type="java.net.URI" index="5"
                         value="${cudl.ui.baseUrl:/ui/}"/>
    </bean>

    <!-- The BuildFactory which provides FrontEndBuild instances for each
         page type. -->
    <bean id="uiBuildFactory"
          factory-bean="cudlUiBuildSelector"
          factory-method="getBuildFactory">
        <constructor-arg type="boolean" value="${cudl.ui.dev:false}"/>
    </bean>
</beans>
